% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/vcf_arrow.R
\name{vcf_to_parquet}
\alias{vcf_to_parquet}
\title{Write VCF/BCF to Parquet format}
\usage{
vcf_to_parquet(
  input_vcf,
  output_parquet,
  compression = "snappy",
  row_group_size = 100000L,
  streaming = FALSE,
  ...
)
}
\arguments{
\item{input_vcf}{Path to input VCF or BCF file}

\item{output_parquet}{Path for output Parquet file}

\item{compression}{Compression codec: "snappy", "gzip", "zstd", "lz4", "uncompressed"}

\item{row_group_size}{Number of rows per row group (default: 100000)}

\item{streaming}{Use streaming mode for large files. When TRUE, writes to
a temporary Arrow IPC file first (via nanoarrow), then converts to Parquet
via DuckDB. This avoids loading the entire VCF into R memory. Requires
the DuckDB nanoarrow community extension. Default is FALSE.}

\item{...}{Additional arguments passed to vcf_open_arrow}
}
\value{
Invisibly returns the output path
}
\description{
Converts a VCF/BCF file to Apache Parquet format for efficient storage
and querying with tools like DuckDB, Spark, or Python pandas/polars.
}
\details{
By default (\code{streaming = FALSE}), the function loads the entire VCF into
memory as a data.frame before writing to Parquet. This is fast for small
to medium files.

For very large VCF files, set \code{streaming = TRUE} to use a two-stage
streaming approach:
\enumerate{
\item Stream VCF to a temporary Arrow IPC file (via nanoarrow)
\item Convert IPC to Parquet via DuckDB (with nanoarrow extension)
}

This keeps R memory usage minimal regardless of file size.
}
\examples{
\dontrun{
# Standard mode (fast, loads into memory)
vcf_to_parquet("variants.vcf.gz", "variants.parquet")

# Streaming mode for large files (low memory)
vcf_to_parquet("huge.vcf.gz", "huge.parquet", streaming = TRUE)

# With zstd compression
vcf_to_parquet("variants.vcf.gz", "variants.parquet", compression = "zstd")

# Query with DuckDB
library(duckdb)
con <- dbConnect(duckdb())
dbGetQuery(con, "SELECT CHROM, POS, REF FROM 'variants.parquet' WHERE CHROM = 'chr1'")
}

}
